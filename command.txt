$data = Import-Csv "C:\Users\antoi\Documents\Home\health\entertainment\videos\qBittorrent_listener\traffic_log.csv"

$data | Group-Object Name | ForEach-Object {
    $torrentName = $_.Name
    $days = $_.Group | Group-Object Date
    
    $row = [ordered]@{ Torrent = $torrentName }
    
    foreach ($day in $days) {
        $stats = $day.Group | Measure-Object Uploaded -Minimum -Maximum
        $diffBytes = $stats.Maximum - $stats.Minimum
        
        # Format to MB or KB
        if ($diffBytes -gt 1MB) { $val = "$([Math]::Round($diffBytes/1MB, 2)) MB" }
        else { $val = "$([Math]::Round($diffBytes/1KB, 2)) KB" }
        
        $row[$day.Name] = $val
    }
    [PSCustomObject]$row
} | Format-Table -AutoSize